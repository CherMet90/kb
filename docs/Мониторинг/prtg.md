##### SSH Script
1. Закидываем файл скрипта по пути `/var/prtg/scripts`
2. Пример скрипта для мониторинга процесса во FreeBSD:  
```
#!/bin/sh
# Проверяем, был ли передан аргумент с именем процесса
if [ $# -eq 0 ]; then
  echo "0:0:Bad argument"
  exit 1
fi
process_name=$1
status=$( /bin/pgrep "$process_name" )
# Проверяем, есть ли такой процесс
if [ -n "$status" ]; then
  # Процесс существует
  echo "2:$status:OK"
else
  # Процесс не найден
  echo "0:0:Down"
fi
```
В общем случае скрипт может принимать аргументы и должен выводить значение в формате `returncode:value:message`  
![returncode_values](../images/returncode_values.PNG)
2.1 С целью траблшутинга можно попробовать выполнить целевую команду из-под пользователя `prtg`:
```
su prtg
```
Выполнив команду, попадаешь в командную строку под указанным пользователем  
3. Дать файлу права 0755
4. Необходимо предусмотреть пользователя, под которым будет заходить PRTG. У пользователя должны быть права на доступ по SSH и права на исполнение файлов (скрипта)
5.1 Получаем список оболочек в системе:  
`cat /etc/shells`
5.2 Устанавливаем пользователю для PRTG оболочку `sh`:  
`chsh -s /bin/sh <имя_пользователя>`
5.3 Проверяем, что оболочка по-умолчанию действительно изменилась:  
`cat /etc/passwd | grep <имя_пользователя>`
6. Креды нужно добавить в настройки родителя сенсора (устройство или группу)
7. Добавляем сенсор `SSH Script`
8. В настройках при необходимости указываем **Sensor Name**, **Parameters** (передаваемые скрипту аругменты) и **Channel Name**